# Day 4 R笔记

## Chapter 5 高级数据管理

### 5.2 数值（数学、统计、概率）函数和字符处理函数

#### 5.2.1 数学函数

常用的数学函数见p86-87表5-2

#### 5.2.2 统计函数

常用的数学函数见p88表5-3

注： trim = 0.05表示丢弃了最大5%和最小5%的数据；na.rm=TRUE表示剔除所有缺失值

#### 5.2.3 概率函数

常用的数学函数见p90表5-4

通过函数set.seed()显式指定这个种子，让结果可以重现。

MASS包中的mvrnorm()函数可以生成给定均值向量和协方差阵的多元正态分 布的数据。

#### 5.2.4 字符处理函数

字符处理函数可以从文本型数据中抽取信息，或者为打印输出和生成报告重设文本的格式。

常见的字符处理函数见p93表5-6

注：`正则表达式`是对字符串（包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为“元字符”））操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。正则表达式是一种文本模式，该模式描述在搜索文本时要匹配的一个或多个字符串。

#### 5.2.5 其他实用函数

常见的字符处理函数见p94表5-7

转义字符的使用方法:\n表示新行，\t为制表符，\\' 为单引号，\b为退格，

#### 5.2.6 将函数应用于矩阵和数据框

apply()函数，可将一个任意函数“应用”到矩阵、数组、数据框的任何维度上。apply()函数的使用格式为： apply(*x*, *MARGIN*, *FUN*, ...)  

其中，*x*为数据对象，*MARGIN*是维度的下标，*FUN*是指定的函数，而...则包括了任何想传 递给*FUN*的参数。在矩阵或数据框中，MARGIN=1表示行，MARGIN=2表示列

### 5.4 控制流

#### 5.4.1 重复和循环

循环结构包括for和 while结构。详见p100-101

#### 5.4.2 条件执行

条件执行结构包括 if-else、ifelse和switch。详见p101-102

### 5.5 用户自编函数

### 5.6 整合与重构

#### 5.6.1 转置

函数t()

#### 5.6.2 整合数据

使用一个或多个by变量和一个预先定义好的函数来折叠（collapse）数据：aggregate(x, *by*, *FUN*)  

其中*x*是待折叠的数据对象，*by*是一个变量名组成的列表，这些变量将被去掉以形成新的观测， 而*FUN*则是用来计算描述性统计量的标量函数，它将被用来计算新观测中的值。

注：在使用aggregate()函数的时候，*by*中的变量必须在一个列表中（即使只有一个变量）。例如 by===list==(……）

#### 5.6.3 **reshape2** 包

* 融合 (melt)

数据集的融合是将它重构为这样一种格式：每个测量变量独占一行，行中带有要唯一确定这个测量所需的标识符变量。

注意，必须指定要唯一确定每个测量所需的变量（ID和Time），而表示测量变量名的变量（X1 或X2）将由程序为你自动创建。(见p106案例)

* 重铸 (dcast)

dcast()函数读取已融合的数据，并使用你提供的公式和一个（可选的）用于整合数据的函 数将其重塑。调用格式为： *newdata* <- dcast(*md*, *formula*, *fun*.*aggregate*)  

其中的*md*为已融合的数据，*formula*描述了想要的最后结果，而*fun.aggregate*是（可选 的）数据整合函数。其接受的公式形如： rowvar1* + *rowvar2* + ... ~ *colvar1* + *colvar2* + ...  

在这一公式中，*rowvar1* + *rowvar2* + ...定义了要划掉的变量集合，以确定各行的内容， 而*colvar1* + *colvar2* + ...则定义了要划掉的、确定各列内容的变量集合。